<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>EDIT CAPS â€” Cap Shop</title>
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Sans:wght@300;400;500;600&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<!-- Keys loaded from config.js â€” this file is in .gitignore, GitHub never sees it -->
<script src="config.js" onerror="console.warn('config.js not found â€” demo mode')"></script>
<style>
  :root {
    --bg: #0a0a0a; --surface: #111111; --card: #161616;
    --border: rgba(255,255,255,0.07); --accent: #f0e040; --accent2: #ff5533;
    --text: #f0ede8; --muted: #666;
    --font-display: 'Bebas Neue', sans-serif;
    --font-body: 'DM Sans', sans-serif;
    --font-mono: 'DM Mono', monospace;
  }
  *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
  html { scroll-behavior: smooth; }
  body { background: var(--bg); color: var(--text); font-family: var(--font-body); overflow-x: hidden; cursor: none; }

  .cursor { position: fixed; width: 12px; height: 12px; background: var(--accent); border-radius: 50%; pointer-events: none; z-index: 9999; transform: translate(-50%,-50%); transition: transform 0.1s, width 0.3s, height 0.3s; mix-blend-mode: difference; }
  .cursor-ring { position: fixed; width: 40px; height: 40px; border: 1.5px solid var(--accent); border-radius: 50%; pointer-events: none; z-index: 9998; transform: translate(-50%,-50%); transition: all 0.15s ease; opacity: 0.5; }
  body::before { content: ''; position: fixed; inset: 0; background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='1'/%3E%3C/svg%3E"); opacity: 0.03; pointer-events: none; z-index: 9990; }
  ::-webkit-scrollbar { width: 4px; } ::-webkit-scrollbar-track { background: var(--bg); } ::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 2px; }

  nav { position: fixed; top: 0; left: 0; right: 0; z-index: 100; display: flex; align-items: center; justify-content: space-between; padding: 1.2rem 3rem; background: rgba(10,10,10,0.8); backdrop-filter: blur(20px); border-bottom: 1px solid var(--border); }
  .nav-logo { font-family: var(--font-display); font-size: 2rem; letter-spacing: 0.1em; color: var(--text); text-decoration: none; }
  .nav-logo span { color: var(--accent); }
  .nav-links { display: flex; gap: 2rem; align-items: center; }
  .nav-links a { font-family: var(--font-mono); font-size: 0.75rem; letter-spacing: 0.12em; text-transform: uppercase; color: var(--muted); text-decoration: none; transition: color 0.3s; position: relative; }
  .nav-links a::after { content: ''; position: absolute; bottom: -2px; left: 0; right: 0; height: 1px; background: var(--accent); transform: scaleX(0); transition: transform 0.3s; }
  .nav-links a:hover { color: var(--text); } .nav-links a:hover::after { transform: scaleX(1); }
  .cart-btn { background: var(--accent); color: #000; border: none; padding: 0.5rem 1.2rem; font-family: var(--font-mono); font-size: 0.75rem; letter-spacing: 0.1em; cursor: none; transition: all 0.3s; }
  .cart-btn:hover { background: var(--text); }
  .cart-count { display: inline-flex; align-items: center; justify-content: center; background: var(--accent2); color: #fff; width: 18px; height: 18px; border-radius: 50%; font-size: 0.65rem; font-weight: 700; margin-left: 6px; }

  .hero { min-height: 100vh; display: grid; grid-template-columns: 1fr 1fr; padding-top: 80px; position: relative; overflow: hidden; }
  .hero-bg-text { position: absolute; bottom: -3rem; left: -1rem; font-family: var(--font-display); font-size: 22vw; color: rgba(255,255,255,0.025); line-height: 1; pointer-events: none; white-space: nowrap; animation: marquee-slow 20s linear infinite; }
  @keyframes marquee-slow { from { transform: translateX(0); } to { transform: translateX(-30%); } }
  .hero-left { display: flex; flex-direction: column; justify-content: center; padding: 6rem 3rem 4rem 3rem; position: relative; z-index: 1; }
  .hero-tag { font-family: var(--font-mono); font-size: 0.7rem; letter-spacing: 0.2em; color: var(--accent); text-transform: uppercase; margin-bottom: 1.5rem; opacity: 0; animation: fadeUp 0.8s ease forwards 0.3s; }
  .hero-title { font-family: var(--font-display); font-size: clamp(5rem,8vw,10rem); line-height: 0.9; margin-bottom: 2rem; }
  .hero-title .line { display: block; overflow: hidden; }
  .hero-title .line span { display: block; opacity: 0; transform: translateY(100%); animation: slideUp 0.9s cubic-bezier(0.16,1,0.3,1) forwards; }
  .hero-title .line:nth-child(1) span { animation-delay: 0.4s; }
  .hero-title .line:nth-child(2) span { animation-delay: 0.55s; }
  .hero-title .line:nth-child(3) span { animation-delay: 0.7s; color: var(--accent); }
  @keyframes slideUp { to { opacity: 1; transform: translateY(0); } }
  @keyframes fadeUp { to { opacity: 1; transform: translateY(0); } }
  .hero-desc { max-width: 380px; color: var(--muted); font-size: 1rem; line-height: 1.7; margin-bottom: 2.5rem; opacity: 0; animation: fadeUp 0.8s ease forwards 0.9s; }
  .hero-ctas { display: flex; gap: 1rem; opacity: 0; animation: fadeUp 0.8s ease forwards 1.1s; }
  .btn-primary { background: var(--accent); color: #000; border: none; padding: 0.85rem 2rem; font-family: var(--font-mono); font-size: 0.8rem; letter-spacing: 0.1em; text-transform: uppercase; cursor: none; text-decoration: none; display: inline-block; transition: all 0.3s cubic-bezier(0.16,1,0.3,1); clip-path: polygon(0 0, calc(100% - 10px) 0, 100% 10px, 100% 100%, 10px 100%, 0 calc(100% - 10px)); }
  .btn-primary:hover { background: var(--text); transform: translateY(-2px); }
  .btn-ghost { background: transparent; color: var(--text); border: 1px solid var(--border); padding: 0.85rem 2rem; font-family: var(--font-mono); font-size: 0.8rem; letter-spacing: 0.1em; text-transform: uppercase; cursor: none; text-decoration: none; display: inline-block; transition: all 0.3s; }
  .btn-ghost:hover { border-color: var(--accent); color: var(--accent); }
  .hero-right { position: relative; display: flex; align-items: center; justify-content: center; overflow: hidden; }
  .hero-visual { position: relative; width: 380px; height: 480px; }
  .hero-cap-card { position: absolute; background: var(--card); border: 1px solid var(--border); padding: 1.5rem; animation: float 6s ease-in-out infinite; opacity: 0; animation-fill-mode: forwards; }
  .hero-cap-card:nth-child(1) { top: 20px; left: 20px; width: 220px; animation-delay: 1.2s; }
  .hero-cap-card:nth-child(2) { bottom: 30px; right: 0; width: 200px; animation-delay: 1.5s; animation-duration: 7s; }
  .hero-cap-card:nth-child(3) { top: 50%; left: 50%; transform: translate(-50%,-50%); animation-delay: 1.8s; animation-duration: 5s; }
  @keyframes float { 0% { opacity: 0; transform: translateY(20px); } 5% { opacity: 1; } 50% { transform: translateY(-10px); } 100% { opacity: 1; transform: translateY(20px); } }
  .cap-emoji { font-size: 4rem; display: block; margin-bottom: 0.5rem; }
  .cap-name { font-family: var(--font-mono); font-size: 0.7rem; letter-spacing: 0.1em; color: var(--muted); }
  .cap-price { font-family: var(--font-display); font-size: 1.8rem; color: var(--accent); margin-top: 0.3rem; }
  .hero-stripe { position: absolute; right: 0; top: 0; bottom: 0; width: 60%; background: linear-gradient(135deg, transparent 30%, rgba(240,224,64,0.03) 100%); border-left: 1px solid var(--border); }

  .marquee-bar { border-top: 1px solid var(--border); border-bottom: 1px solid var(--border); background: var(--accent); padding: 0.7rem 0; overflow: hidden; display: flex; }
  .marquee-track { display: flex; animation: marquee 12s linear infinite; white-space: nowrap; }
  .marquee-track span { font-family: var(--font-display); font-size: 1rem; letter-spacing: 0.15em; color: #000; padding: 0 2rem; }
  .marquee-track span.dot { color: var(--accent2); }
  @keyframes marquee { from { transform: translateX(0); } to { transform: translateX(-50%); } }

  .section { padding: 6rem 3rem; }
  .section-header { display: flex; align-items: flex-end; justify-content: space-between; margin-bottom: 3rem; }
  .section-label { font-family: var(--font-mono); font-size: 0.7rem; letter-spacing: 0.2em; color: var(--accent); text-transform: uppercase; margin-bottom: 0.5rem; }
  .section-title { font-family: var(--font-display); font-size: clamp(2.5rem,5vw,5rem); line-height: 1; }
  .products-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1.5px; background: var(--border); border: 1px solid var(--border); }
  .product-card { background: var(--card); cursor: none; position: relative; overflow: hidden; opacity: 0; transform: translateY(30px); transition: opacity 0.6s ease, transform 0.6s ease, background 0.3s; }
  .product-card.visible { opacity: 1; transform: translateY(0); }
  .product-card:hover { background: var(--surface); }
  .product-image { height: 240px; display: flex; align-items: center; justify-content: center; background: var(--bg); position: relative; overflow: hidden; border-bottom: 1px solid var(--border); transition: transform 0.5s cubic-bezier(0.16,1,0.3,1); }
  .product-card:hover .product-image { transform: scale(1.02); }
  .product-image img { width: 100%; height: 100%; object-fit: cover; display: block; }
  .product-emoji-fallback { font-size: 6rem; }
  .product-badge { position: absolute; top: 1rem; right: 1rem; background: var(--accent2); color: #fff; font-family: var(--font-mono); font-size: 0.6rem; letter-spacing: 0.1em; padding: 0.25rem 0.5rem; text-transform: uppercase; }
  .product-info { padding: 1.5rem; }
  .product-category { font-family: var(--font-mono); font-size: 0.65rem; letter-spacing: 0.15em; color: var(--muted); text-transform: uppercase; margin-bottom: 0.4rem; }
  .product-name { font-size: 1.1rem; font-weight: 600; margin-bottom: 0.25rem; line-height: 1.3; }
  .product-desc { font-size: 0.8rem; color: var(--muted); line-height: 1.5; margin-bottom: 1.2rem; }
  .product-footer { display: flex; align-items: center; justify-content: space-between; }
  .product-price { font-family: var(--font-display); font-size: 1.8rem; color: var(--accent); }
  .product-price .currency { font-size: 0.9rem; color: var(--muted); font-family: var(--font-mono); }
  .add-btn { background: transparent; color: var(--accent); border: 1px solid var(--accent); padding: 0.5rem 1rem; font-family: var(--font-mono); font-size: 0.7rem; letter-spacing: 0.1em; cursor: none; text-transform: uppercase; transition: all 0.25s; }
  .add-btn:hover { background: var(--accent); color: #000; transform: translateY(-1px); }
  .add-btn.added { background: var(--accent2); border-color: var(--accent2); color: #fff; }
  .products-loading { grid-column: 1/-1; display: flex; align-items: center; justify-content: center; padding: 4rem; gap: 1rem; }
  .load-dot { width: 8px; height: 8px; background: var(--accent); border-radius: 50%; animation: loadPulse 1.2s ease-in-out infinite; }
  .load-dot:nth-child(2) { animation-delay: 0.2s; } .load-dot:nth-child(3) { animation-delay: 0.4s; }
  @keyframes loadPulse { 0%,80%,100% { transform: scale(0.6); opacity: 0.4; } 40% { transform: scale(1); opacity: 1; } }

  .cart-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.7); z-index: 200; opacity: 0; pointer-events: none; transition: opacity 0.3s; backdrop-filter: blur(4px); }
  .cart-overlay.open { opacity: 1; pointer-events: all; }
  .cart-sidebar { position: fixed; top: 0; right: 0; bottom: 0; width: 420px; background: var(--surface); border-left: 1px solid var(--border); z-index: 201; transform: translateX(100%); transition: transform 0.4s cubic-bezier(0.16,1,0.3,1); display: flex; flex-direction: column; }
  .cart-sidebar.open { transform: translateX(0); }
  .cart-header { padding: 2rem 2rem 1.5rem; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; }
  .cart-title { font-family: var(--font-display); font-size: 2rem; }
  .cart-close { background: none; border: none; color: var(--muted); font-size: 1.5rem; cursor: none; transition: color 0.2s; line-height: 1; }
  .cart-close:hover { color: var(--text); }
  .cart-items { flex: 1; overflow-y: auto; padding: 1.5rem 2rem; }
  .cart-empty { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; color: var(--muted); gap: 1rem; }
  .cart-empty-icon { font-size: 4rem; }
  .cart-item { display: flex; align-items: center; gap: 1rem; padding: 1rem 0; border-bottom: 1px solid var(--border); animation: fadeUp 0.3s ease; }
  .cart-item-thumb { width: 52px; height: 52px; flex-shrink: 0; background: var(--card); border: 1px solid var(--border); display: flex; align-items: center; justify-content: center; font-size: 1.8rem; overflow: hidden; }
  .cart-item-thumb img { width: 100%; height: 100%; object-fit: cover; }
  .cart-item-info { flex: 1; }
  .cart-item-name { font-weight: 500; font-size: 0.9rem; margin-bottom: 0.2rem; }
  .cart-item-price { font-family: var(--font-mono); font-size: 0.8rem; color: var(--accent); }
  .cart-item-remove { background: none; border: none; color: var(--muted); cursor: none; font-size: 1.1rem; transition: color 0.2s; padding: 0.25rem; }
  .cart-item-remove:hover { color: var(--accent2); }
  .cart-footer { padding: 1.5rem 2rem; border-top: 1px solid var(--border); }
  .cart-total { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.2rem; }
  .cart-total-label { font-family: var(--font-mono); font-size: 0.75rem; color: var(--muted); letter-spacing: 0.1em; }
  .cart-total-amount { font-family: var(--font-display); font-size: 2rem; color: var(--accent); }
  .checkout-btn { width: 100%; background: var(--accent); color: #000; border: none; padding: 1rem; font-family: var(--font-display); font-size: 1.2rem; letter-spacing: 0.05em; cursor: none; transition: all 0.3s; clip-path: polygon(0 0, calc(100% - 14px) 0, 100% 14px, 100% 100%, 14px 100%, 0 calc(100% - 14px)); }
  .checkout-btn:hover { background: var(--text); transform: translateY(-2px); }

  .admin-panel { position: fixed; inset: 0; background: var(--bg); z-index: 300; display: none; flex-direction: column; }
  .admin-panel.open { display: flex; }
  .admin-nav { padding: 1.2rem 2rem; background: var(--surface); border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 2rem; }
  .admin-logo { font-family: var(--font-display); font-size: 1.5rem; color: var(--accent); }
  .admin-tabs { display: flex; gap: 0.5rem; margin-left: auto; }
  .admin-tab { background: none; border: 1px solid var(--border); color: var(--muted); padding: 0.4rem 1rem; font-family: var(--font-mono); font-size: 0.7rem; letter-spacing: 0.1em; cursor: none; transition: all 0.2s; }
  .admin-tab.active, .admin-tab:hover { background: var(--accent); color: #000; border-color: var(--accent); }
  .admin-close { background: none; border: 1px solid var(--border); color: var(--muted); padding: 0.4rem 1rem; font-family: var(--font-mono); font-size: 0.7rem; cursor: none; transition: all 0.2s; }
  .admin-close:hover { border-color: var(--accent2); color: var(--accent2); }
  .admin-body { flex: 1; overflow-y: auto; padding: 2rem; }
  .admin-section { display: none; } .admin-section.active { display: block; }
  .admin-form { background: var(--card); border: 1px solid var(--border); padding: 2rem; max-width: 600px; margin-bottom: 2rem; }
  .form-title { font-family: var(--font-display); font-size: 1.8rem; margin-bottom: 1.5rem; color: var(--accent); }
  .form-row { margin-bottom: 1.2rem; }
  .form-label { display: block; font-family: var(--font-mono); font-size: 0.7rem; letter-spacing: 0.1em; color: var(--muted); text-transform: uppercase; margin-bottom: 0.5rem; }
  .form-input, .form-select, .form-textarea { width: 100%; background: var(--bg); border: 1px solid var(--border); color: var(--text); padding: 0.7rem 1rem; font-family: var(--font-body); font-size: 0.9rem; outline: none; transition: border-color 0.2s; }
  .form-input:focus, .form-select:focus, .form-textarea:focus { border-color: var(--accent); }
  .form-textarea { height: 80px; resize: vertical; } .form-select option { background: var(--bg); }
  .form-row-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
  .form-submit { background: var(--accent); color: #000; border: none; padding: 0.8rem 2rem; font-family: var(--font-display); font-size: 1.1rem; cursor: none; transition: all 0.3s; margin-top: 0.5rem; }
  .form-submit:hover { background: var(--text); }

  /* IMAGE UPLOAD */
  .upload-area { border: 2px dashed var(--border); padding: 2rem; text-align: center; cursor: none; transition: all 0.3s; position: relative; background: var(--bg); }
  .upload-area:hover, .upload-area.dragover { border-color: var(--accent); background: rgba(240,224,64,0.03); }
  .upload-area input[type=file] { position: absolute; inset: 0; opacity: 0; cursor: pointer; width: 100%; height: 100%; }
  .upload-icon { font-size: 2.5rem; margin-bottom: 0.5rem; display: block; }
  .upload-text { font-family: var(--font-mono); font-size: 0.7rem; letter-spacing: 0.1em; color: var(--muted); text-transform: uppercase; }
  .upload-text em { color: var(--accent); font-style: normal; }
  .upload-preview { margin-top: 1rem; position: relative; display: inline-block; }
  .upload-preview img { width: 120px; height: 120px; object-fit: cover; border: 1px solid var(--border); display: block; }
  .upload-preview-remove { position: absolute; top: -8px; right: -8px; background: var(--accent2); color: #fff; border: none; width: 22px; height: 22px; border-radius: 50%; font-size: 0.7rem; cursor: none; display: flex; align-items: center; justify-content: center; transition: transform 0.2s; }
  .upload-preview-remove:hover { transform: scale(1.15); }
  .upload-progress { margin-top: 0.8rem; height: 3px; background: var(--border); position: relative; overflow: hidden; }
  .upload-progress-bar { height: 100%; background: var(--accent); width: 0%; transition: width 0.3s; }

  .admin-products-table { width: 100%; border-collapse: collapse; background: var(--card); border: 1px solid var(--border); }
  .admin-products-table th { text-align: left; padding: 0.8rem 1rem; font-family: var(--font-mono); font-size: 0.65rem; letter-spacing: 0.12em; color: var(--muted); text-transform: uppercase; border-bottom: 1px solid var(--border); background: var(--surface); }
  .admin-products-table td { padding: 0.8rem 1rem; border-bottom: 1px solid var(--border); font-size: 0.85rem; vertical-align: middle; }
  .admin-products-table tr:hover td { background: rgba(255,255,255,0.02); }
  .table-thumb { width: 40px; height: 40px; object-fit: cover; border: 1px solid var(--border); }
  .table-thumb-emoji { font-size: 1.5rem; }
  .table-badge { display: inline-block; background: rgba(240,224,64,0.15); color: var(--accent); border: 1px solid rgba(240,224,64,0.3); padding: 0.15rem 0.5rem; font-family: var(--font-mono); font-size: 0.65rem; letter-spacing: 0.08em; }
  .table-action { background: none; border: 1px solid var(--border); color: var(--muted); padding: 0.25rem 0.6rem; font-family: var(--font-mono); font-size: 0.65rem; cursor: none; transition: all 0.2s; margin-right: 0.3rem; }
  .table-action:hover { border-color: var(--accent2); color: var(--accent2); }

  .status-dot { width: 7px; height: 7px; border-radius: 50%; background: var(--muted); display: inline-block; }
  .status-dot.connected { background: #4caf50; box-shadow: 0 0 6px #4caf50; }
  .status-dot.error { background: var(--accent2); }
  .status-dot.blink { animation: blink 1s infinite; }
  @keyframes blink { 0%,100% { opacity: 1; } 50% { opacity: 0.3; } }

  .supabase-config { background: rgba(240,224,64,0.05); border: 1px solid rgba(240,224,64,0.2); padding: 1.5rem; margin-bottom: 2rem; }
  .supabase-config-title { font-family: var(--font-mono); font-size: 0.7rem; letter-spacing: 0.15em; color: var(--accent); text-transform: uppercase; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem; }

  footer { border-top: 1px solid var(--border); padding: 4rem 3rem 2rem; display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 3rem; }
  .footer-logo { font-family: var(--font-display); font-size: 2.5rem; margin-bottom: 0.5rem; }
  .footer-logo span { color: var(--accent); }
  .footer-tagline { color: var(--muted); font-size: 0.85rem; line-height: 1.6; max-width: 280px; }
  .footer-col h4 { font-family: var(--font-mono); font-size: 0.65rem; letter-spacing: 0.2em; text-transform: uppercase; color: var(--accent); margin-bottom: 1rem; }
  .footer-col a { display: block; color: var(--muted); text-decoration: none; font-size: 0.85rem; margin-bottom: 0.5rem; transition: color 0.2s; }
  .footer-col a:hover { color: var(--text); }
  .footer-bottom { padding: 1.5rem 3rem; border-top: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
  .footer-bottom p { font-family: var(--font-mono); font-size: 0.65rem; color: var(--muted); letter-spacing: 0.05em; }

  .toast-container { position: fixed; bottom: 2rem; left: 50%; transform: translateX(-50%); z-index: 500; display: flex; flex-direction: column; gap: 0.5rem; align-items: center; pointer-events: none; }
  .toast { background: var(--card); border: 1px solid var(--border); border-left: 3px solid var(--accent); padding: 0.8rem 1.5rem; font-family: var(--font-mono); font-size: 0.75rem; letter-spacing: 0.05em; white-space: nowrap; animation: toastIn 0.3s ease, toastOut 0.3s ease 2.7s forwards; }
  .toast.error { border-left-color: var(--accent2); }
  @keyframes toastIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
  @keyframes toastOut { from { opacity: 1; } to { opacity: 0; } }
  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

  @media (max-width: 768px) {
    nav { padding: 1rem 1.5rem; }
    .hero { grid-template-columns: 1fr; }
    .hero-right { display: none; }
    .section { padding: 4rem 1.5rem; }
    .cart-sidebar { width: 100%; }
    footer { grid-template-columns: 1fr; gap: 2rem; }
    .footer-bottom { flex-direction: column; gap: 0.5rem; }
  }
</style>
</head>
<body>

<div class="cursor" id="cursor"></div>
<div class="cursor-ring" id="cursorRing"></div>
<div class="toast-container" id="toastContainer"></div>

<!-- NAV -->
<nav>
  <a href="#" class="nav-logo">EDIT<span>CAPS</span></a>
  <div class="nav-links">
    <a href="#products">Catalog</a>
    <a href="#about">About</a>
    <a href="#" id="adminToggleBtn">Admin</a>
    <button class="cart-btn" id="cartToggleBtn">Cart <span class="cart-count" id="cartCount">0</span></button>
  </div>
</nav>

<!-- HERO -->
<section class="hero">
  <div class="hero-left">
    <p class="hero-tag">// New Collection 2025</p>
    <h1 class="hero-title">
      <span class="line"><span>EDIT</span></span>
      <span class="line"><span>CAPS</span></span>
      <span class="line"><span>SHOP</span></span>
    </h1>
    <p class="hero-desc">Caps for those who know style. Every piece â€” a statement. Every drop â€” a moment.</p>
    <div class="hero-ctas">
      <a href="#products" class="btn-primary">Shop All</a>
      <a href="#about" class="btn-ghost">Our Story</a>
    </div>
  </div>
  <div class="hero-right">
    <div class="hero-stripe"></div>
    <div class="hero-visual">
      <div class="hero-cap-card">
        <span class="cap-emoji">ðŸ§¢</span>
        <div class="cap-name">SNAPBACK PRO</div>
        <div class="cap-price">$29 <small style="font-size:1rem;color:var(--muted)">USD</small></div>
      </div>
      <div class="hero-cap-card">
        <span class="cap-emoji">ðŸŽ©</span>
        <div class="cap-name">BUCKET WAVE</div>
        <div class="cap-price">$22 <small style="font-size:1rem;color:var(--muted)">USD</small></div>
      </div>
      <div class="hero-cap-card" style="width:180px;padding:1rem">
        <span style="font-family:var(--font-display);font-size:0.9rem;color:var(--accent)">NEW DROP</span>
        <div style="font-family:var(--font-mono);font-size:0.65rem;color:var(--muted);margin-top:0.3rem">Every week</div>
      </div>
    </div>
  </div>
  <div class="hero-bg-text">EDITCAPS EDITCAPS EDITCAPS</div>
</section>

<!-- MARQUEE -->
<div class="marquee-bar">
  <div class="marquee-track">
    <span>NEW COLLECTION</span><span class="dot"> âœ¦ </span><span>SNAPBACK PRO</span><span class="dot"> âœ¦ </span><span>BUCKET HAT</span><span class="dot"> âœ¦ </span><span>FITTED CLASSIC</span><span class="dot"> âœ¦ </span><span>FREE SHIPPING</span><span class="dot"> âœ¦ </span><span>LIMITED EDITION</span><span class="dot"> âœ¦ </span><span>EDIT CAPS SHOP</span><span class="dot"> âœ¦ </span>
    <span>NEW COLLECTION</span><span class="dot"> âœ¦ </span><span>SNAPBACK PRO</span><span class="dot"> âœ¦ </span><span>BUCKET HAT</span><span class="dot"> âœ¦ </span><span>FITTED CLASSIC</span><span class="dot"> âœ¦ </span><span>FREE SHIPPING</span><span class="dot"> âœ¦ </span><span>LIMITED EDITION</span><span class="dot"> âœ¦ </span><span>EDIT CAPS SHOP</span><span class="dot"> âœ¦ </span>
  </div>
</div>

<!-- PRODUCTS -->
<section class="section" id="products">
  <div class="section-header">
    <div>
      <div class="section-label">// Catalog</div>
      <h2 class="section-title">ALL CAPS</h2>
    </div>
    <div style="display:flex;align-items:center;gap:0.5rem">
      <div class="status-dot blink" id="dbStatusDot"></div>
      <span style="font-family:var(--font-mono);font-size:0.65rem;color:var(--muted)" id="dbStatusText">Connecting...</span>
    </div>
  </div>
  <div class="products-grid" id="productsGrid">
    <div class="products-loading"><div class="load-dot"></div><div class="load-dot"></div><div class="load-dot"></div></div>
  </div>
</section>

<!-- ABOUT -->
<section class="section" id="about" style="background:var(--surface);border-top:1px solid var(--border)">
  <div class="section-label">// About</div>
  <div style="display:grid;grid-template-columns:1fr 1fr;gap:4rem;align-items:center;margin-top:2rem">
    <div>
      <h2 class="section-title" style="margin-bottom:1.5rem">WE<br>MAKE<br><span style="color:var(--accent)">STYLE</span></h2>
      <p style="color:var(--muted);line-height:1.8;max-width:400px">Edit Caps is more than a shop. It's where street culture meets refined taste. Every cap in our catalog is handpicked with obsessive attention to detail.</p>
    </div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:1.5px;background:var(--border)">
      <div style="background:var(--card);padding:2rem;text-align:center"><div style="font-family:var(--font-display);font-size:3.5rem;color:var(--accent)">42+</div><div style="font-family:var(--font-mono);font-size:0.65rem;letter-spacing:0.15em;color:var(--muted);text-transform:uppercase;margin-top:0.3rem">Models</div></div>
      <div style="background:var(--card);padding:2rem;text-align:center"><div style="font-family:var(--font-display);font-size:3.5rem;color:var(--accent)">2K+</div><div style="font-family:var(--font-mono);font-size:0.65rem;letter-spacing:0.15em;color:var(--muted);text-transform:uppercase;margin-top:0.3rem">Customers</div></div>
      <div style="background:var(--card);padding:2rem;text-align:center"><div style="font-family:var(--font-display);font-size:3.5rem;color:var(--accent)">100%</div><div style="font-family:var(--font-mono);font-size:0.65rem;letter-spacing:0.15em;color:var(--muted);text-transform:uppercase;margin-top:0.3rem">Quality</div></div>
      <div style="background:var(--card);padding:2rem;text-align:center"><div style="font-family:var(--font-display);font-size:3.5rem;color:var(--accent)">âˆž</div><div style="font-family:var(--font-mono);font-size:0.65rem;letter-spacing:0.15em;color:var(--muted);text-transform:uppercase;margin-top:0.3rem">Style</div></div>
    </div>
  </div>
</section>

<!-- FOOTER -->
<footer>
  <div>
    <div class="footer-logo">EDIT<span>CAPS</span></div>
    <p class="footer-tagline">Caps that complete the look. Every day. For everyone.</p>
  </div>
  <div class="footer-col">
    <h4>Shop</h4>
    <a href="#">All Caps</a><a href="#">Snapback</a><a href="#">Fitted</a><a href="#">Bucket Hat</a><a href="#">New In</a>
  </div>
  <div class="footer-col">
    <h4>Help</h4>
    <a href="#">Shipping</a><a href="#">Returns</a><a href="#">FAQ</a><a href="#">Contact</a>
  </div>
</footer>
<div class="footer-bottom">
  <p>Â© 2025 EDIT CAPS SHOP â€” All rights reserved</p>
  <p style="color:var(--accent)">Made with ðŸ§¢ & code</p>
</div>

<!-- CART -->
<div class="cart-overlay" id="cartOverlay"></div>
<div class="cart-sidebar" id="cartSidebar">
  <div class="cart-header">
    <div class="cart-title">CART</div>
    <button class="cart-close" id="cartCloseBtn">âœ•</button>
  </div>
  <div class="cart-items" id="cartItems">
    <div class="cart-empty"><span class="cart-empty-icon">ðŸ§¢</span><p style="font-family:var(--font-mono);font-size:0.75rem;letter-spacing:0.1em;color:var(--muted)">CART IS EMPTY</p></div>
  </div>
  <div class="cart-footer">
    <div class="cart-total">
      <span class="cart-total-label">TOTAL</span>
      <span class="cart-total-amount" id="cartTotal">$0</span>
    </div>
    <button class="checkout-btn" onclick="showToast('Checkout coming soon!')">CHECKOUT</button>
  </div>
</div>

<!-- ADMIN -->
<div class="admin-panel" id="adminPanel">
  <div class="admin-nav">
    <div class="admin-logo">âš¡ ADMIN</div>
    <div style="font-family:var(--font-mono);font-size:0.65rem;color:var(--muted)">Edit Caps Dashboard</div>
    <div class="admin-tabs">
      <button class="admin-tab active" onclick="switchAdminTab('products',this)">Products</button>
      <button class="admin-tab" onclick="switchAdminTab('add',this)">+ Add</button>
      <button class="admin-tab" onclick="switchAdminTab('settings',this)">Settings</button>
    </div>
    <button class="admin-close" id="adminCloseBtn">âœ• Close</button>
  </div>
  <div class="admin-body">

    <div class="admin-section active" id="adminProducts">
      <div style="font-family:var(--font-display);font-size:2rem;margin-bottom:1.5rem">All Products</div>
      <table class="admin-products-table">
        <thead><tr><th>Image</th><th>Name</th><th>Price</th><th>Category</th><th>Status</th><th>Actions</th></tr></thead>
        <tbody id="adminTableBody"><tr><td colspan="6" style="text-align:center;padding:3rem;color:var(--muted);font-family:var(--font-mono);font-size:0.75rem">Loading...</td></tr></tbody>
      </table>
    </div>

    <div class="admin-section" id="adminAdd">
      <div class="admin-form">
        <div class="form-title">New Product</div>
        <div class="form-row">
          <label class="form-label">Product Image</label>
          <div class="upload-area" id="uploadArea">
            <input type="file" id="imageFileInput" accept="image/*" onchange="handleImageSelect(this)">
            <span class="upload-icon">ðŸ“¸</span>
            <div class="upload-text">Drop image here or <em>click to upload</em></div>
            <div style="font-family:var(--font-mono);font-size:0.6rem;color:var(--muted);margin-top:0.3rem;text-transform:uppercase;letter-spacing:0.1em">JPG, PNG, WEBP Â· Max 5MB</div>
          </div>
          <div id="uploadPreviewWrap" style="display:none" class="upload-preview">
            <img id="uploadPreviewImg" src="" alt="preview">
            <button class="upload-preview-remove" onclick="clearImageUpload()">âœ•</button>
          </div>
          <div class="upload-progress" id="uploadProgress" style="display:none">
            <div class="upload-progress-bar" id="uploadProgressBar"></div>
          </div>
        </div>
        <div class="form-row">
          <label class="form-label">Name</label>
          <input class="form-input" id="formName" placeholder="Snapback Pro Black">
        </div>
        <div class="form-row">
          <label class="form-label">Description</label>
          <textarea class="form-textarea" id="formDesc" placeholder="Classic flat-brim snapback with embroidery..."></textarea>
        </div>
        <div class="form-row-2">
          <div>
            <label class="form-label">Price ($)</label>
            <input class="form-input" id="formPrice" type="number" placeholder="29">
          </div>
          <div>
            <label class="form-label">Emoji (fallback)</label>
            <input class="form-input" id="formEmoji" placeholder="ðŸ§¢" maxlength="2">
          </div>
        </div>
        <div class="form-row-2">
          <div>
            <label class="form-label">Category</label>
            <select class="form-select" id="formCategory">
              <option value="snapback">Snapback</option>
              <option value="fitted">Fitted</option>
              <option value="bucket">Bucket Hat</option>
              <option value="trucker">Trucker</option>
              <option value="other">Other</option>
            </select>
          </div>
          <div>
            <label class="form-label">Status</label>
            <select class="form-select" id="formStatus">
              <option value="active">Active</option>
              <option value="new">New</option>
              <option value="sale">Sale</option>
              <option value="hidden">Hidden</option>
            </select>
          </div>
        </div>
        <button class="form-submit" onclick="addProduct()">ADD PRODUCT</button>
      </div>
    </div>

    <div class="admin-section" id="adminSettings">
      <div class="admin-form">
        <div class="form-title">Supabase</div>
        <div class="supabase-config">
          <div class="supabase-config-title">
            <span class="status-dot" id="supaStatusDot"></span>
            Status: <span id="supaStatusLabel">not connected</span>
          </div>
          <div style="font-family:var(--font-mono);font-size:0.7rem;color:var(--muted);line-height:1.8">Connect your Supabase database. Keys are session-only.</div>
        </div>
        <div class="form-row">
          <label class="form-label">Supabase URL</label>
          <input class="form-input" id="supaUrl" placeholder="https://xxxx.supabase.co">
        </div>
        <div class="form-row">
          <label class="form-label">Supabase Anon Key</label>
          <input class="form-input" id="supaKey" placeholder="eyJhbGci..." type="password">
        </div>
        <div style="background:var(--bg);border:1px solid var(--border);padding:1rem;margin-bottom:1.2rem;font-family:var(--font-mono);font-size:0.7rem;color:var(--muted);line-height:1.8">
          <div style="color:var(--accent);margin-bottom:0.5rem">// Run in Supabase SQL Editor</div>
          <div>ALTER TABLE products ADD COLUMN IF NOT EXISTS image_url text;</div>
          <br>
          <div style="color:var(--accent);margin-bottom:0.5rem">// Storage: create bucket "product-images" â†’ set Public</div>
        </div>
        <button class="form-submit" onclick="connectSupabase()">CONNECT</button>
      </div>
    </div>

  </div>
</div>

<script>
// CURSOR
const cursor = document.getElementById('cursor');
const cursorRing = document.getElementById('cursorRing');
let mx=0,my=0,rx=0,ry=0;
document.addEventListener('mousemove',e=>{mx=e.clientX;my=e.clientY;cursor.style.left=mx+'px';cursor.style.top=my+'px';});
(function animRing(){rx+=(mx-rx)*0.12;ry+=(my-ry)*0.12;cursorRing.style.left=rx+'px';cursorRing.style.top=ry+'px';requestAnimationFrame(animRing);})();
document.addEventListener('mousedown',()=>{cursor.style.transform='translate(-50%,-50%) scale(0.7)';cursorRing.style.transform='translate(-50%,-50%) scale(0.8)';});
document.addEventListener('mouseup',()=>{cursor.style.transform='translate(-50%,-50%) scale(1)';cursorRing.style.transform='translate(-50%,-50%) scale(1)';});

// STATE
let supabaseClient=null,products=[],cart=[];
let sessionUrl=null,sessionKey=null,adminUnlocked=false,pendingImageFile=null;

// STATUS
function setDbStatus(state,text){
  const dot=document.getElementById('dbStatusDot'),label=document.getElementById('dbStatusText');
  if(!dot||!label)return;
  dot.className='status-dot '+(state==='connected'?'connected':state==='error'?'error':'blink');
  label.textContent=text;
}

// TOAST
function showToast(msg,type='default'){
  const c=document.getElementById('toastContainer'),t=document.createElement('div');
  t.className='toast'+(type==='error'?' error':'');t.textContent=msg;
  c.appendChild(t);setTimeout(()=>t.remove(),3000);
}

// SUPABASE CONNECT
async function connectSupabase(){
  const url=document.getElementById('supaUrl')?.value?.trim()||'';
  const key=document.getElementById('supaKey')?.value?.trim()||'';
  if(!url||!key){showToast('Enter URL and Key!','error');return;}
  try{
    supabaseClient=supabase.createClient(url,key);
    const{error}=await supabaseClient.from('products').select('id').limit(1);
    if(error&&error.code!=='PGRST116')throw error;
    sessionUrl=url;sessionKey=key;adminUnlocked=true;
    setDbStatus('connected','Supabase connected âœ“');
    document.getElementById('supaStatusDot').className='status-dot connected';
    document.getElementById('supaStatusLabel').textContent='connected';
    showToast('Connected!');loadProducts();
  }catch(e){showToast('Error: '+e.message,'error');setDbStatus('error','Error');}
}

// DEMO PRODUCTS
const DEMO=[
  {id:1,name:'Snapback Pro Black',description:'Classic flat-brim snapback with embroidered logo',price:29,emoji:'ðŸ§¢',category:'snapback',status:'new'},
  {id:2,name:'Bucket Wave White',description:'Cotton bucket hat with wide brim',price:22,emoji:'ðŸª£',category:'bucket',status:'active'},
  {id:3,name:'Fitted Classic Navy',description:'Stretch-fit cap, no strap needed',price:38,emoji:'ðŸŽ“',category:'fitted',status:'active'},
  {id:4,name:'Trucker Mesh Beige',description:'Mesh back cap with adjustable snap',price:19,emoji:'ðŸšš',category:'trucker',status:'sale'},
  {id:5,name:'Corduroy Dad Cap',description:'Vintage corduroy dad cap in retro style',price:25,emoji:'ðŸŽ©',category:'other',status:'new'},
  {id:6,name:'Logo 5-Panel Camp',description:'Minimalist 5-panel with logo patch',price:24,emoji:'â›º',category:'other',status:'active'},
];

function loadDemoProducts(){products=DEMO;setDbStatus('','Demo mode');renderProducts();renderAdminTable();}

async function loadProducts(){
  if(!supabaseClient)return loadDemoProducts();
  setDbStatus('blink','Loading...');
  try{
    const{data,error}=await supabaseClient.from('products').select('*').neq('status','hidden').order('created_at',{ascending:false});
    if(error)throw error;
    products=data.length>0?data:DEMO;
    setDbStatus('connected',`${products.length} products loaded`);
    renderProducts();renderAdminTable();
  }catch(e){loadDemoProducts();}
}

// CATEGORY LABEL
function getCatLabel(cat){return{snapback:'Snapback',fitted:'Fitted',bucket:'Bucket Hat',trucker:'Trucker',other:'Other'}[cat]||cat||'Caps';}

// RENDER PRODUCTS
function renderProducts(){
  const grid=document.getElementById('productsGrid');
  if(!grid)return;
  if(!products.length){grid.innerHTML='<div class="products-loading"><p style="font-family:var(--font-mono);font-size:0.75rem;color:var(--muted)">No products found</p></div>';return;}
  grid.innerHTML=products.map((p,i)=>`
    <div class="product-card" style="transition-delay:${i*0.07}s">
      <div class="product-image">
        ${p.status==='new'?'<span class="product-badge">NEW</span>':''}
        ${p.status==='sale'?'<span class="product-badge" style="background:var(--accent);color:#000">SALE</span>':''}
        ${p.image_url?`<img src="${p.image_url}" alt="${p.name}" loading="lazy">`:`<span class="product-emoji-fallback">${p.emoji||'ðŸ§¢'}</span>`}
      </div>
      <div class="product-info">
        <div class="product-category">${getCatLabel(p.category)}</div>
        <div class="product-name">${p.name}</div>
        <div class="product-desc">${p.description||''}</div>
        <div class="product-footer">
          <div class="product-price">$${Number(p.price).toLocaleString('en')} <span class="currency">USD</span></div>
          <button class="add-btn" onclick="addToCart(${JSON.stringify(p).replace(/"/g,'&quot;')},this)">Add to Cart</button>
        </div>
      </div>
    </div>`).join('');
  const obs=new IntersectionObserver(entries=>entries.forEach(e=>{if(e.isIntersecting)e.target.classList.add('visible');}),{threshold:0.1});
  grid.querySelectorAll('.product-card').forEach(c=>obs.observe(c));
}

// ADMIN TABLE
function renderAdminTable(){
  const tbody=document.getElementById('adminTableBody');
  if(!tbody)return;
  if(!products.length){tbody.innerHTML='<tr><td colspan="6" style="text-align:center;padding:3rem;color:var(--muted);font-family:var(--font-mono);font-size:0.75rem">No products</td></tr>';return;}
  tbody.innerHTML=products.map(p=>`
    <tr>
      <td>${p.image_url?`<img src="${p.image_url}" class="table-thumb" alt="">`:`<span class="table-thumb-emoji">${p.emoji||'ðŸ§¢'}</span>`}</td>
      <td><strong>${p.name}</strong></td>
      <td style="font-family:var(--font-mono);color:var(--accent)">$${Number(p.price).toLocaleString('en')}</td>
      <td>${getCatLabel(p.category)}</td>
      <td><span class="table-badge">${p.status||'active'}</span></td>
      <td><button class="table-action" onclick="deleteProduct('${p.id}')">Delete</button></td>
    </tr>`).join('');
}

// IMAGE UPLOAD
function handleImageSelect(input){
  const file=input.files[0];
  if(!file)return;
  if(file.size>5*1024*1024){showToast('Image too large! Max 5MB','error');return;}
  pendingImageFile=file;
  const reader=new FileReader();
  reader.onload=e=>{
    document.getElementById('uploadPreviewImg').src=e.target.result;
    document.getElementById('uploadPreviewWrap').style.display='block';
  };
  reader.readAsDataURL(file);
}

function clearImageUpload(){
  pendingImageFile=null;
  document.getElementById('imageFileInput').value='';
  document.getElementById('uploadPreviewWrap').style.display='none';
  document.getElementById('uploadPreviewImg').src='';
  document.getElementById('uploadProgress').style.display='none';
  document.getElementById('uploadProgressBar').style.width='0%';
}

async function uploadImage(file){
  const ext=file.name.split('.').pop();
  const fileName=`cap-${Date.now()}.${ext}`;
  document.getElementById('uploadProgress').style.display='block';
  document.getElementById('uploadProgressBar').style.width='30%';
  const{error}=await supabaseClient.storage.from('product-images').upload(fileName,file,{cacheControl:'3600',upsert:false});
  document.getElementById('uploadProgressBar').style.width='80%';
  if(error)throw error;
  const{data}=supabaseClient.storage.from('product-images').getPublicUrl(fileName);
  document.getElementById('uploadProgressBar').style.width='100%';
  setTimeout(()=>{document.getElementById('uploadProgress').style.display='none';},600);
  return data.publicUrl;
}

// Drag & drop
const ua=document.getElementById('uploadArea');
if(ua){
  ua.addEventListener('dragover',e=>{e.preventDefault();ua.classList.add('dragover');});
  ua.addEventListener('dragleave',()=>ua.classList.remove('dragover'));
  ua.addEventListener('drop',e=>{
    e.preventDefault();ua.classList.remove('dragover');
    const f=e.dataTransfer.files[0];
    if(f&&f.type.startsWith('image/')){pendingImageFile=f;const r=new FileReader();r.onload=ev=>{document.getElementById('uploadPreviewImg').src=ev.target.result;document.getElementById('uploadPreviewWrap').style.display='block';};r.readAsDataURL(f);}
  });
}

// ADD PRODUCT
async function addProduct(){
  const name=document.getElementById('formName').value.trim();
  const desc=document.getElementById('formDesc').value.trim();
  const price=parseFloat(document.getElementById('formPrice').value);
  const emoji=document.getElementById('formEmoji').value||'ðŸ§¢';
  const category=document.getElementById('formCategory').value;
  const status=document.getElementById('formStatus').value;
  if(!name||!price){showToast('Fill in name and price!','error');return;}

  let imageUrl=null;
  if(pendingImageFile){
    if(!supabaseClient){showToast('Connect Supabase to upload images!','error');return;}
    try{showToast('Uploading image...');imageUrl=await uploadImage(pendingImageFile);}
    catch(e){showToast('Upload failed: '+e.message,'error');return;}
  }

  const prod={name,description:desc,price,emoji,category,status,image_url:imageUrl};
  if(supabaseClient){
    try{
      const{data,error}=await supabaseClient.from('products').insert([prod]).select();
      if(error)throw error;
      products.unshift(data[0]);showToast('Product added! âœ“');
    }catch(e){showToast('Error: '+e.message,'error');return;}
  }else{
    prod.id=Date.now();products.unshift(prod);showToast('Added (demo mode)');
  }
  renderProducts();renderAdminTable();
  ['formName','formDesc','formPrice','formEmoji'].forEach(id=>document.getElementById(id).value='');
  clearImageUpload();
  switchAdminTab('products',document.querySelector('.admin-tab'));
}

// DELETE
async function deleteProduct(id){
  if(!confirm('Delete this product?'))return;
  if(supabaseClient){
    const{error}=await supabaseClient.from('products').delete().eq('id',id);
    if(error){showToast('Error: '+error.message,'error');return;}
  }
  products=products.filter(p=>String(p.id)!==String(id));
  renderProducts();renderAdminTable();showToast('Product deleted');
}

// CART
function addToCart(p,btn){
  cart.push(p);btn.textContent='âœ“ Added';btn.classList.add('added');
  setTimeout(()=>{btn.textContent='Add to Cart';btn.classList.remove('added');},1500);
  updateCart();showToast(`${p.emoji||'ðŸ§¢'} ${p.name} added to cart!`);
}
function removeFromCart(i){cart.splice(i,1);updateCart();}
function updateCart(){
  document.getElementById('cartCount').textContent=cart.length;
  const items=document.getElementById('cartItems');
  if(!cart.length){
    items.innerHTML='<div class="cart-empty"><span class="cart-empty-icon">ðŸ§¢</span><p style="font-family:var(--font-mono);font-size:0.75rem;letter-spacing:0.1em;color:var(--muted)">CART IS EMPTY</p></div>';
  }else{
    items.innerHTML=cart.map((p,i)=>`
      <div class="cart-item">
        <div class="cart-item-thumb">${p.image_url?`<img src="${p.image_url}" alt="">`:p.emoji||'ðŸ§¢'}</div>
        <div class="cart-item-info">
          <div class="cart-item-name">${p.name}</div>
          <div class="cart-item-price">$${Number(p.price).toLocaleString('en')}</div>
        </div>
        <button class="cart-item-remove" onclick="removeFromCart(${i})">âœ•</button>
      </div>`).join('');
  }
  document.getElementById('cartTotal').textContent='$'+cart.reduce((s,p)=>s+Number(p.price),0).toLocaleString('en');
}
document.getElementById('cartToggleBtn').onclick=()=>toggleCart(true);
document.getElementById('cartCloseBtn').onclick=()=>toggleCart(false);
document.getElementById('cartOverlay').onclick=()=>toggleCart(false);
function toggleCart(open){document.getElementById('cartOverlay').classList.toggle('open',open);document.getElementById('cartSidebar').classList.toggle('open',open);}

// ADMIN LOGIN
document.getElementById('adminToggleBtn').onclick=e=>{e.preventDefault();adminUnlocked?document.getElementById('adminPanel').classList.add('open'):showAdminLogin();};
document.getElementById('adminCloseBtn').onclick=()=>document.getElementById('adminPanel').classList.remove('open');

function showAdminLogin(){
  document.getElementById('adminLoginModal')?.remove();
  const modal=document.createElement('div');
  modal.id='adminLoginModal';
  modal.style.cssText='position:fixed;inset:0;z-index:400;background:rgba(0,0,0,0.85);backdrop-filter:blur(12px);display:flex;align-items:center;justify-content:center;animation:fadeIn 0.2s ease;';
  modal.innerHTML=`<div style="background:#111;border:1px solid rgba(240,224,64,0.25);width:100%;max-width:460px;padding:2.5rem;box-shadow:0 0 60px rgba(240,224,64,0.07);">
    <div style="font-family:'Bebas Neue',sans-serif;font-size:2rem;color:#f0e040;margin-bottom:0.3rem;">âš¡ ADMIN LOGIN</div>
    <div style="font-family:'DM Mono',monospace;font-size:0.65rem;letter-spacing:0.15em;color:#555;margin-bottom:2rem;text-transform:uppercase;">Enter Supabase keys â€” never saved anywhere</div>
    <div style="margin-bottom:1rem;">
      <label style="display:block;font-family:'DM Mono',monospace;font-size:0.65rem;letter-spacing:0.12em;color:#555;text-transform:uppercase;margin-bottom:0.4rem;">Supabase URL</label>
      <input id="loginUrl" type="text" placeholder="https://xxxx.supabase.co" style="width:100%;background:#0a0a0a;border:1px solid rgba(255,255,255,0.1);color:#f0ede8;padding:0.7rem 1rem;font-family:'DM Mono',monospace;font-size:0.8rem;outline:none;" onfocus="this.style.borderColor='#f0e040'" onblur="this.style.borderColor='rgba(255,255,255,0.1)'">
    </div>
    <div style="margin-bottom:0.5rem;">
      <label style="display:block;font-family:'DM Mono',monospace;font-size:0.65rem;letter-spacing:0.12em;color:#555;text-transform:uppercase;margin-bottom:0.4rem;">Anon Key</label>
      <div style="position:relative;">
        <input id="loginKey" type="password" placeholder="eyJhbGci..." style="width:100%;background:#0a0a0a;border:1px solid rgba(255,255,255,0.1);color:#f0ede8;padding:0.7rem 2.5rem 0.7rem 1rem;font-family:'DM Mono',monospace;font-size:0.8rem;outline:none;" onfocus="this.style.borderColor='#f0e040'" onblur="this.style.borderColor='rgba(255,255,255,0.1)'" onkeydown="if(event.key==='Enter')attemptAdminLogin()">
        <button onclick="document.getElementById('loginKey').type=document.getElementById('loginKey').type==='password'?'text':'password'" style="position:absolute;right:0.8rem;top:50%;transform:translateY(-50%);background:none;border:none;color:#555;cursor:pointer;font-size:1rem;">ðŸ‘</button>
      </div>
    </div>
    <div style="font-family:'DM Mono',monospace;font-size:0.65rem;color:#333;margin-bottom:1.8rem;line-height:1.6;">// Keys live only in tab memory â€” never reach GitHub.</div>
    <div style="display:flex;gap:0.8rem;">
      <button onclick="attemptAdminLogin()" id="loginBtn" style="flex:1;background:#f0e040;color:#000;border:none;padding:0.85rem;font-family:'Bebas Neue',sans-serif;font-size:1.1rem;cursor:pointer;transition:all 0.2s;" onmouseover="this.style.background='#fff'" onmouseout="this.style.background='#f0e040'">SIGN IN</button>
      <button onclick="document.getElementById('adminLoginModal').remove()" style="background:transparent;color:#555;border:1px solid rgba(255,255,255,0.08);padding:0.85rem 1.2rem;font-family:'DM Mono',monospace;font-size:0.75rem;cursor:pointer;" onmouseover="this.style.borderColor='#ff5533';this.style.color='#ff5533'" onmouseout="this.style.borderColor='rgba(255,255,255,0.08)';this.style.color='#555'">Cancel</button>
    </div>
    <div id="loginError" style="margin-top:1rem;font-family:'DM Mono',monospace;font-size:0.7rem;color:#ff5533;letter-spacing:0.05em;display:none;"></div>
  </div>`;
  document.body.appendChild(modal);
  modal.addEventListener('click',e=>{if(e.target===modal)modal.remove();});
  setTimeout(()=>document.getElementById('loginUrl')?.focus(),100);
}

async function attemptAdminLogin(){
  const url=document.getElementById('loginUrl')?.value?.trim();
  const key=document.getElementById('loginKey')?.value?.trim();
  const btn=document.getElementById('loginBtn');
  if(!url||!key){showLoginError('Fill in both fields!');return;}
  if(btn){btn.textContent='CHECKING...';btn.style.opacity='0.7';}
  try{
    const c=supabase.createClient(url,key);
    const{error}=await c.from('products').select('id').limit(1);
    if(error&&error.code!=='PGRST116')throw error;
    sessionUrl=url;sessionKey=key;supabaseClient=c;adminUnlocked=true;
    document.getElementById('adminLoginModal')?.remove();
    document.getElementById('adminPanel').classList.add('open');
    showToast('Welcome! âœ“');setDbStatus('connected','Supabase connected âœ“');
    loadProducts();
  }catch(e){
    if(btn){btn.textContent='SIGN IN';btn.style.opacity='1';}
    showLoginError('Wrong keys: '+(e.message||'check URL and Key'));
  }
}
function showLoginError(msg){const el=document.getElementById('loginError');if(!el)return;el.textContent='âœ• '+msg;el.style.display='block';}

// ADMIN TABS
function switchAdminTab(tab,btn){
  document.querySelectorAll('.admin-section').forEach(s=>s.classList.remove('active'));
  document.querySelectorAll('.admin-tab').forEach(t=>t.classList.remove('active'));
  document.getElementById('admin'+tab.charAt(0).toUpperCase()+tab.slice(1)).classList.add('active');
  if(btn)btn.classList.add('active');
}

// INIT
async function init(){
  const cfg=window.EDITCAPS_CONFIG;
  if(cfg&&cfg.supabaseUrl&&cfg.supabaseKey&&!cfg.supabaseUrl.includes('Ð¢Ð’ÐžÐ™_ÐŸÐ ÐžÐ•ÐšÐ¢')){
    try{
      supabaseClient=supabase.createClient(cfg.supabaseUrl,cfg.supabaseKey);
      sessionUrl=cfg.supabaseUrl;sessionKey=cfg.supabaseKey;
      setDbStatus('blink','Loading products...');
      await loadProducts();
    }catch(e){loadDemoProducts();}
  }else{loadDemoProducts();setDbStatus('','Demo mode');}
}
init();
</script>
</body>
</html>
